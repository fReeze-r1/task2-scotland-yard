package ru.cs.vsu.oop.task2.lopatin_n.core;

import java.util.*;

public class GameBoard {
    private final Map<Integer, Station> stations;
    private static final int[] RIVER_STATIONS = {108, 115, 157, 194};

    public GameBoard() {
        this.stations = new HashMap<>();
        initializeBoard();
    }

    private void initializeBoard() {
        for (int i = 1; i <= 200; i++) {
            stations.put(i, new Station(i));
        }
        initializeConnections();
    }

    private void initializeConnections() {
        initializeTaxiConnections();
        initializeBusConnections();
        initializeUndergroundConnections();
        initializeRiverConnections();
    }

    private void initializeTaxiConnections() {
        int[][] taxiRoutes = {
            {1, 8, 9}, {2, 10, 20}, {3, 4, 12, 13}, {4, 3, 13},
            {5, 15, 16}, {6, 7, 29}, {7, 6, 42}, {8, 1, 9, 19},
            {9, 1, 8, 19, 20}, {10, 2, 11, 21, 34}, {11, 10, 22},
            {12, 3, 23}, {13, 3, 4, 23, 24}, {14, 15, 25},
            {15, 5, 14, 16, 26, 29}, {16, 5, 15, 28, 29},
            {17, 29, 30}, {18, 30, 31, 43}, {19, 8, 9, 20, 32},
            {20, 2, 9, 19, 33, 34}, {21, 10, 33, 35},
            {22, 11, 23, 36, 37}, {23, 12, 13, 22, 24, 37, 38},
            {24, 13, 23, 38, 39}, {25, 14, 26, 40}, {26, 15, 25, 27, 41},
            {27, 26, 28, 42}, {28, 16, 27, 42, 43}, {29, 6, 15, 16, 17, 42, 55},
            {30, 17, 18, 31, 43, 44}, {31, 18, 30, 32, 45, 46},
            {32, 19, 31, 46, 47}, {33, 20, 21, 34, 48}, {34, 10, 20, 33, 49},
            {35, 21, 36, 50}, {36, 22, 35, 50, 51}, {37, 22, 23, 38, 51},
            {38, 23, 24, 37, 39, 52}, {39, 24, 38, 52, 53},
            {40, 25, 41, 54}, {41, 26, 40, 42, 54, 55}, {42, 7, 27, 28, 29, 41, 56},
            {43, 18, 28, 30, 44, 57}, {44, 30, 43, 45, 58},
            {45, 31, 44, 46, 58, 59}, {46, 31, 32, 45, 47, 59, 60},
            {47, 32, 46, 61}, {48, 33, 49, 62}, {49, 34, 48, 50, 62, 63},
            {50, 35, 36, 49, 51, 63}, {51, 36, 37, 50, 52, 64},
            {52, 38, 39, 51, 53, 65}, {53, 39, 52, 66, 67},
            {54, 40, 41, 55, 67}, {55, 29, 41, 54, 56, 68},
            {56, 42, 55, 69}, {57, 43, 58, 70}, {58, 44, 45, 57, 59, 71},
            {59, 45, 46, 58, 60, 72}, {60, 46, 59, 61, 72, 73},
            {61, 47, 60, 73, 74}, {62, 48, 49, 63, 75}, {63, 49, 50, 62, 64, 76},
            {64, 51, 63, 65, 76, 77}, {65, 52, 64, 66, 77, 78},
            {66, 53, 65, 67, 78, 79}, {67, 53, 54, 66, 80},
            {68, 55, 69, 81}, {69, 56, 68, 82}, {70, 57, 71, 83},
            {71, 58, 70, 72, 84}, {72, 59, 60, 71, 73, 85},
            {73, 60, 61, 72, 74, 85}, {74, 61, 73, 75, 86},
            {75, 62, 74, 76, 87}, {76, 63, 64, 75, 77, 88},
            {77, 64, 65, 76, 78, 89}, {78, 65, 66, 77, 79, 90},
            {79, 66, 78, 80, 91}, {80, 67, 79, 92}, {81, 68, 82, 93},
            {82, 69, 81, 94}, {83, 70, 84, 95}, {84, 71, 83, 85, 96},
            {85, 72, 73, 84, 86, 97}, {86, 74, 85, 87, 98},
            {87, 75, 86, 88, 99}, {88, 76, 87, 89, 100},
            {89, 77, 88, 90, 101}, {90, 78, 89, 91, 102},
            {91, 79, 90, 92, 103}, {92, 80, 91, 104}, {93, 81, 94, 105},
            {94, 82, 93, 95, 105}, {95, 83, 94, 96, 107},
            {96, 84, 95, 97, 108}, {97, 85, 96, 98, 109},
            {98, 86, 97, 99, 110}, {99, 87, 98, 100, 111},
            {100, 88, 99, 101, 112}, {101, 89, 100, 102, 113},
            {102, 90, 101, 103, 114}, {103, 91, 102, 104, 115},
            {104, 92, 103, 116}, {105, 93, 94, 106, 117},
            {106, 105, 107, 118}, {107, 95, 106, 119},
            {108, 96, 109, 115, 157}, {109, 97, 108, 110, 120},
            {110, 98, 109, 111, 121}, {111, 99, 110, 112, 122},
            {112, 100, 111, 113, 123}, {113, 101, 112, 114, 124},
            {114, 102, 113, 115, 125}, {115, 103, 108, 114, 116, 157},
            {116, 104, 115, 117, 126}, {117, 105, 116, 118, 127},
            {118, 106, 117, 119, 128}, {119, 107, 118, 120, 129},
            {120, 109, 119, 121, 130}, {121, 110, 120, 122, 131},
            {122, 111, 121, 123, 132}, {123, 112, 122, 124, 133},
            {124, 113, 123, 125, 134}, {125, 114, 124, 126, 135},
            {126, 116, 125, 127, 136}, {127, 117, 126, 128, 137},
            {128, 118, 127, 129, 138}, {129, 119, 128, 130, 139},
            {130, 120, 129, 131, 140}, {131, 121, 130, 132, 141},
            {132, 122, 131, 133, 142}, {133, 123, 132, 134, 143},
            {134, 124, 133, 135, 144}, {135, 125, 134, 136, 145},
            {136, 126, 135, 137, 146}, {137, 127, 136, 138, 147},
            {138, 128, 137, 139, 148}, {139, 129, 138, 140, 149},
            {140, 130, 139, 141, 150}, {141, 131, 140, 142, 151},
            {142, 132, 141, 143, 152}, {143, 133, 142, 144, 153},
            {144, 134, 143, 145, 154}, {145, 135, 144, 146, 155},
            {146, 136, 145, 147, 156}, {147, 137, 146, 148, 157},
            {148, 138, 147, 149, 158}, {149, 139, 148, 150, 159},
            {150, 140, 149, 151, 160}, {151, 141, 150, 152, 161},
            {152, 142, 151, 153, 162}, {153, 143, 152, 154, 163},
            {154, 144, 153, 155, 164}, {155, 145, 154, 156, 165},
            {156, 146, 155, 157, 166}, {157, 108, 115, 147, 156, 167, 194},
            {158, 148, 159, 168}, {159, 149, 158, 160, 169},
            {160, 150, 159, 161, 170}, {161, 151, 160, 162, 171},
            {162, 152, 161, 163, 172}, {163, 153, 162, 164, 173},
            {164, 154, 163, 165, 174}, {165, 155, 164, 166, 175},
            {166, 156, 165, 167, 176}, {167, 157, 166, 177},
            {168, 158, 169, 178}, {169, 159, 168, 170, 179},
            {170, 160, 169, 171, 180}, {171, 161, 170, 172, 181},
            {172, 162, 171, 173, 182}, {173, 163, 172, 174, 183},
            {174, 164, 173, 175, 184}, {175, 165, 174, 176, 185},
            {176, 166, 175, 177, 186}, {177, 167, 176, 187},
            {178, 168, 179, 188}, {179, 169, 178, 180, 189},
            {180, 170, 179, 181, 190}, {181, 171, 180, 182, 191},
            {182, 172, 181, 183, 192}, {183, 173, 182, 184, 193},
            {184, 174, 183, 185, 194}, {185, 175, 184, 186, 195},
            {186, 176, 185, 187, 196}, {187, 177, 186, 197},
            {188, 178, 189, 198}, {189, 179, 188, 190, 199},
            {190, 180, 189, 191, 200}, {191, 181, 190, 192},
            {192, 182, 191, 193}, {193, 183, 192, 194},
            {194, 108, 115, 157, 184, 193, 195}, {195, 185, 194, 196},
            {196, 186, 195, 197}, {197, 187, 196, 198},
            {198, 188, 197, 199}, {199, 189, 198, 200},
            {200, 190, 199}
        };

        for (int[] route : taxiRoutes) {
            int stationNum = route[0];
            Station station = stations.get(stationNum);
            for (int i = 1; i < route.length; i++) {
                Station connected = stations.get(route[i]);
                if (connected != null) {
                    station.addConnection(TicketType.TAXI, connected);
                    connected.addConnection(TicketType.TAXI, station);
                }
            }
        }
    }

    private void initializeBusConnections() {
        int[][] busRoutes = {
            {1, 46, 58}, {2, 20, 34}, {3, 12, 13, 23, 24}, {4, 13, 23},
            {5, 15, 26, 29}, {6, 29, 42}, {7, 42, 46}, {8, 9, 19, 32},
            {9, 8, 19, 20}, {10, 20, 21, 34}, {11, 22, 23},
            {12, 3, 13, 23}, {13, 3, 4, 12, 23, 24}, {14, 15, 26},
            {15, 5, 14, 26, 29, 41}, {16, 28, 29, 42}, {17, 29, 30, 43},
            {18, 30, 43, 46}, {19, 8, 9, 32, 46}, {20, 2, 9, 10, 21, 34},
            {21, 10, 20, 33, 35, 50}, {22, 11, 23, 36, 51},
            {23, 3, 4, 11, 12, 13, 22, 24, 37, 38}, {24, 13, 23, 38, 39},
            {25, 26, 40, 41}, {26, 14, 15, 25, 41, 42}, {27, 28, 42},
            {28, 16, 27, 42, 43, 46}, {29, 5, 6, 15, 16, 17, 41, 42, 55},
            {30, 17, 18, 43, 44, 46}, {31, 32, 45, 46, 47},
            {32, 8, 19, 31, 46, 47}, {33, 20, 21, 34, 48, 49},
            {34, 2, 10, 20, 33, 49}, {35, 21, 36, 50, 63},
            {36, 22, 35, 50, 51}, {37, 23, 38, 51, 52},
            {38, 23, 24, 37, 39, 52}, {39, 24, 38, 52, 53},
            {40, 25, 41, 54}, {41, 15, 25, 26, 29, 40, 42, 54, 55},
            {42, 6, 7, 16, 26, 27, 28, 29, 41, 46, 56}, {43, 17, 18, 28, 30, 46, 57},
            {44, 30, 45, 58}, {45, 31, 44, 46, 58, 59}, {46, 1, 7, 18, 19, 28, 30, 31, 32, 42, 43, 45, 47, 58},
            {47, 31, 32, 46, 58, 61}, {48, 33, 49, 62}, {49, 33, 34, 48, 50, 62, 63},
            {50, 21, 35, 36, 49, 51, 63, 64}, {51, 22, 36, 37, 50, 52, 64},
            {52, 37, 38, 39, 51, 53, 65}, {53, 39, 52, 66, 67},
            {54, 40, 41, 55, 67, 68}, {55, 29, 41, 54, 56, 68, 69},
            {56, 42, 55, 69, 89}, {57, 43, 58, 70, 71}, {58, 1, 44, 45, 46, 47, 57, 70, 71},
            {59, 45, 46, 58, 60, 72}, {60, 59, 61, 72, 73}, {61, 47, 60, 73, 74},
            {62, 48, 49, 63, 75, 76}, {63, 35, 49, 50, 62, 64, 76},
            {64, 50, 51, 63, 65, 76, 77}, {65, 52, 64, 66, 77, 78},
            {66, 53, 65, 67, 78, 79}, {67, 53, 54, 66, 80, 100},
            {68, 54, 55, 69, 81, 82}, {69, 55, 56, 68, 82, 89},
            {70, 57, 58, 71, 83, 84}, {71, 57, 58, 70, 72, 84},
            {72, 59, 60, 71, 73, 85}, {73, 60, 61, 72, 74, 85, 86},
            {74, 61, 73, 75, 86, 87}, {75, 62, 74, 76, 87, 88},
            {76, 62, 63, 64, 75, 77, 88}, {77, 64, 65, 76, 78, 89},
            {78, 65, 66, 77, 79, 90}, {79, 66, 78, 80, 91, 100},
            {80, 67, 79, 92, 100}, {81, 68, 82, 93, 94}, {82, 68, 69, 81, 94},
            {83, 70, 84, 95, 96}, {84, 70, 71, 83, 85, 96},
            {85, 72, 73, 84, 86, 97}, {86, 73, 74, 85, 87, 98},
            {87, 74, 75, 86, 88, 99}, {88, 75, 76, 87, 89, 100},
            {89, 56, 69, 77, 88, 100, 101}, {90, 78, 89, 101, 102},
            {91, 79, 90, 92, 102, 103}, {92, 80, 91, 103, 104},
            {93, 81, 94, 105, 106}, {94, 81, 82, 93, 95, 105},
            {95, 83, 94, 96, 107}, {96, 83, 84, 95, 97, 108},
            {97, 85, 96, 98, 109}, {98, 86, 97, 99, 110},
            {99, 87, 98, 100, 111}, {100, 67, 79, 80, 88, 89, 99, 101, 112},
            {101, 89, 90, 100, 102, 113}, {102, 90, 91, 101, 103, 114},
            {103, 91, 92, 102, 104, 115}, {104, 92, 103, 116, 117},
            {105, 93, 94, 106, 117}, {106, 105, 107, 118},
            {107, 95, 106, 119}, {108, 96, 109, 115, 157},
            {109, 97, 108, 110, 120}, {110, 98, 109, 111, 121},
            {111, 99, 110, 112, 122}, {112, 100, 111, 113, 123},
            {113, 101, 112, 114, 124}, {114, 102, 113, 115, 125},
            {115, 103, 108, 114, 116, 157}, {116, 104, 115, 117, 126},
            {117, 104, 105, 116, 118, 127}, {118, 106, 117, 119, 128},
            {119, 107, 118, 120, 129}, {120, 109, 119, 121, 130},
            {121, 110, 120, 122, 131}, {122, 111, 121, 123, 132},
            {123, 112, 122, 124, 133}, {124, 113, 123, 125, 134},
            {125, 114, 124, 126, 135}, {126, 116, 125, 127, 136},
            {127, 117, 126, 128, 137}, {128, 118, 127, 129, 138},
            {129, 119, 128, 130, 139}, {130, 120, 129, 131, 140},
            {131, 121, 130, 132, 141}, {132, 122, 131, 133, 142},
            {133, 123, 132, 134, 143}, {134, 124, 133, 135, 144},
            {135, 125, 134, 136, 145}, {136, 126, 135, 137, 146},
            {137, 127, 136, 138, 147}, {138, 128, 137, 139, 148},
            {139, 129, 138, 140, 149}, {140, 130, 139, 141, 150},
            {141, 131, 140, 142, 151}, {142, 132, 141, 143, 152},
            {143, 133, 142, 144, 153}, {144, 134, 143, 145, 154},
            {145, 135, 144, 146, 155}, {146, 136, 145, 147, 156},
            {147, 137, 146, 148, 157}, {148, 138, 147, 149, 158},
            {149, 139, 148, 150, 159}, {150, 140, 149, 151, 160},
            {151, 141, 150, 152, 161}, {152, 142, 151, 153, 162},
            {153, 143, 152, 154, 163}, {154, 144, 153, 155, 164},
            {155, 145, 154, 156, 165}, {156, 146, 155, 157, 166},
            {157, 108, 115, 147, 156, 167, 194}, {158, 148, 159, 168},
            {159, 149, 158, 160, 169}, {160, 150, 159, 161, 170},
            {161, 151, 160, 162, 171}, {162, 152, 161, 163, 172},
            {163, 153, 162, 164, 173}, {164, 154, 163, 165, 174},
            {165, 155, 164, 166, 175}, {166, 156, 165, 167, 176},
            {167, 157, 166, 177}, {168, 158, 169, 178},
            {169, 159, 168, 170, 179}, {170, 160, 169, 171, 180},
            {171, 161, 170, 172, 181}, {172, 162, 171, 173, 182},
            {173, 163, 172, 174, 183}, {174, 164, 173, 175, 184},
            {175, 165, 174, 176, 185}, {176, 166, 175, 177, 186},
            {177, 167, 176, 187}, {178, 168, 179, 188},
            {179, 169, 178, 180, 189}, {180, 170, 179, 181, 190},
            {181, 171, 180, 182, 191}, {182, 172, 181, 183, 192},
            {183, 173, 182, 184, 193}, {184, 174, 183, 185, 194},
            {185, 175, 184, 186, 195}, {186, 176, 185, 187, 196},
            {187, 177, 186, 197}, {188, 178, 189, 198},
            {189, 179, 188, 190, 199}, {190, 180, 189, 191, 200},
            {191, 181, 190, 192}, {192, 182, 191, 193},
            {193, 183, 192, 194}, {194, 108, 115, 157, 184, 193, 195},
            {195, 185, 194, 196}, {196, 186, 195, 197}, {197, 187, 196, 198},
            {198, 188, 197, 199}, {199, 189, 198, 200}, {200, 190, 199}
        };

        for (int[] route : busRoutes) {
            int stationNum = route[0];
            Station station = stations.get(stationNum);
            for (int i = 1; i < route.length; i++) {
                Station connected = stations.get(route[i]);
                if (connected != null) {
                    station.addConnection(TicketType.BUS, connected);
                    connected.addConnection(TicketType.BUS, station);
                }
            }
        }
    }

    private void initializeUndergroundConnections() {
        int[][] undergroundRoutes = {
            {13, 46, 52, 67, 89, 111, 140, 153, 180},
            {46, 13, 52, 67, 89, 111, 140, 153, 180},
            {52, 13, 46, 67, 89, 111, 140, 153, 180},
            {67, 13, 46, 52, 89, 111, 140, 153, 180},
            {89, 13, 46, 52, 67, 111, 140, 153, 180},
            {111, 13, 46, 52, 67, 89, 140, 153, 180},
            {140, 13, 46, 52, 67, 89, 111, 153, 180},
            {153, 13, 46, 52, 67, 89, 111, 140, 180},
            {180, 13, 46, 52, 67, 89, 111, 140, 153}
        };

        for (int[] route : undergroundRoutes) {
            int stationNum = route[0];
            Station station = stations.get(stationNum);
            for (int i = 1; i < route.length; i++) {
                Station connected = stations.get(route[i]);
                if (connected != null) {
                    station.addConnection(TicketType.UNDERGROUND, connected);
                    connected.addConnection(TicketType.UNDERGROUND, station);
                }
            }
        }
    }

    private void initializeRiverConnections() {
        Station station108 = stations.get(108);
        Station station115 = stations.get(115);
        Station station157 = stations.get(157);
        Station station194 = stations.get(194);

        if (station108 != null && station115 != null) {
            station108.addConnection(TicketType.BLACK, station115);
            station115.addConnection(TicketType.BLACK, station108);
        }
        if (station108 != null && station157 != null) {
            station108.addConnection(TicketType.BLACK, station157);
            station157.addConnection(TicketType.BLACK, station108);
        }
        if (station115 != null && station157 != null) {
            station115.addConnection(TicketType.BLACK, station157);
            station157.addConnection(TicketType.BLACK, station115);
        }
        if (station115 != null && station194 != null) {
            station115.addConnection(TicketType.BLACK, station194);
            station194.addConnection(TicketType.BLACK, station115);
        }
        if (station157 != null && station194 != null) {
            station157.addConnection(TicketType.BLACK, station194);
            station194.addConnection(TicketType.BLACK, station157);
        }
    }

    public Station getStation(int number) {
        return stations.get(number);
    }

    public boolean isRiverStation(int number) {
        for (int riverStation : RIVER_STATIONS) {
            if (riverStation == number) {
                return true;
            }
        }
        return false;
    }

    public Set<Station> getAllStations() {
        return new HashSet<>(stations.values());
    }
}

